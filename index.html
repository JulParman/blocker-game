<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <div>
        <button onclick="startGame()">Start</button>
    </div>

    <canvas id="myCanvas" width="600" height="300" style="border:1px solid #000000;">
    </canvas>
    <br>
    <button onclick="up()">UP</button>
    <br>
    <button onclick="down()">Down</button>
</head>
<body>
<script type="text/javascript" src="app.js"></script>
<script type="text/javascript" src="player.js"></script>
<script type="text/javascript" src="obstacle.js"></script>
<script type="text/javascript" src="obstacle2.js"></script>
<script>
    var Player = blockerApp.player();
    var c = document.getElementById("myCanvas");
    var ctx = c.getContext("2d");
    var frameCount = 0;
    var obs;
    var obs2;
    var img = new Image();
    document.onkeydown = keyBoard;


    function startGame() {
        img.onload = function () {
            setInterval(function () {
                clear();
                draw();
                countFrames();
                checkCollision();
            }, 20);
        };
        img.src = "favicon.png";
    }

    function clear() {
        ctx.clearRect(0, 0, c.width, c.height);
    }

    function countFrames() {
        frameCount++;

        if (frameCount === 200) {
            frameCount = 0;
            var rnd = Math.floor((Math.random() * 200) + 1);
            obs = new blockerApp.obstacle(rnd);
            obs2 = new blockerApp.obstacle2(rnd);
        }
        if (obs) {
            ctx.fillRect(obs.x -= 3, obs.y, obs.width, obs.height);
            ctx.fillRect(obs2.x -= 3, obs2.y, obs2.width, obs2.height);
        }

    }

    function checkCollision() {
        if (!(Player.x > obs.x + obs.width || Player.x + Player.width < obs.x || Player.y > obs.y + obs.height || Player.y + Player.height < obs.y)) {
            gameOver();
        }
        else if (!(Player.x > obs2.x + obs2.width || Player.x + Player.width < obs2.x || Player.y > obs2.y + obs2.height || Player.y + Player.height < obs2.y)) {
            gameOver();
        }
    }

    function gameOver() {
        ctx.font = "30px Arial";
        ctx.fillText("Game over!", 200, 50);
    }

    function draw() {
        ctx.drawImage(img, Player.x, Player.y, Player.width, Player.height);
    }

    function keyBoard(e) {
        if (e.keyCode === 38) {
            Player.y -= 10;
        }
        if (e.keyCode === 40) {
            Player.y += 10;
        }
    }

    function up() {
        if (Player.y >= 5) {
            Player.y -= 10;
        }
    }

    function down() {
        if (Player.y <= 250) {
            Player.y += 10;
        }
    }


</script>
</body>
</html>